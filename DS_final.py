import subprocess
import re
import csv 

def cleanhtml(raw_html):
  cleanr = re.compile('<.*?>')
  cleantext = re.sub(cleanr, '', raw_html)
  return cleantext

result = subprocess.check_output('curl -d "__VIEWSTATE=%2FwEPDwULLTE4NTA1NzM1MzQPFgIeE1ZhbGlkYXRlUmVxdWVzdE1vZGUCARYCZg9kFgQCBQ8WAh4JaW5uZXJodG1sBf4sPHVsIGlkPSdtZW51JyBzdHlsZT0nd2lkdGg6IDEwMjRweDsgbWFyZ2luOiAwIGF1dG87ICc%2BPGxpPjxhIElEPSAnbFBhSE9NRScgc3R5bGUgPSd3aWR0aDo2NXB4JyBocmVmPSdEZWZhdWx0LmFzcHgnPlRyYW5nIGNo4bunPC9hPjxsaT48YSBJRD0gJ2xQYUNURFQnIHN0eWxlID0nd2lkdGg6ODVweCcgaHJlZj0nJz5DaMawxqFuZyB0csOsbmg8L2E%2BPHVsIGNsYXNzPSdzdWJtZW51Jz48bGk%2BPGEgSUQgPSdsQ29DVERUQzInICAgc3R5bGUgPSd3aWR0aDoxNDBweCcgaHJlZj0nR19MaXN0Q1REVC5hc3B4Jz5DaMawxqFuZyB0csOsbmggxJHDoG8gdOG6oW88L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29DVERUQzEnICAgc3R5bGUgPSd3aWR0aDoxNDBweCcgaHJlZj0nR19MaXN0SG9jUGhhbi5hc3B4Jz5I4buNYyBwaOG6p248L2E%2BPC9saT48L3VsPjwvbGk%2BPGxpPjxhIElEPSAnbFBhS0hEVCcgc3R5bGUgPSd3aWR0aDo2MHB4JyBocmVmPScnPkvhur8gaG%2FhuqFjaDwvYT48dWwgY2xhc3M9J3N1Ym1lbnUnPjxsaT48YSBJRCA9J2xDb0tIRFRDMScgICBzdHlsZSA9J3dpZHRoOjIwMHB4JyBocmVmPSdodHRwczovL2RyaXZlLmdvb2dsZS5jb20vZmlsZS9kLzFFMDZfZjJlQ3d4YmhwRGlEN0pvUGoydFBCeEp5a3ZmWC92aWV3Jz5L4bq%2FIGhv4bqhY2ggxJHDoG8gdOG6oW8gbsSDbSBo4buNYzwvYT48L2xpPjxsaT48YSBJRCA9J2xDb0tIRFRDMicgICBzdHlsZSA9J3dpZHRoOjIwMHB4JyBocmVmPSdodHRwOi8vZGs0LmR1dC51ZG4udm4nPsSQxINuZyBrw70gaOG7jWM8L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29LSERUQzMnICAgc3R5bGUgPSd3aWR0aDoyMDBweCcgaHJlZj0naHR0cDovL2RrNC5kdXQudWRuLnZuL0dfTG9wSG9jUGhhbi5hc3B4Jz5M4bubcCBo4buNYyBwaOG6p24gLSDEkWFuZyDEkcSDbmcga8O9PC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvS0hEVEM0JyAgIHN0eWxlID0nd2lkdGg6MjAwcHgnIGhyZWY9J0dfTG9wSG9jUGhhbi5hc3B4Jz5M4bubcCBo4buNYyBwaOG6p24gLSBjaMOtbmggdGjhu6ljPC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvS0hEVEM1JyAgIHN0eWxlID0nd2lkdGg6MjAwcHgnIGhyZWY9J2h0dHA6Ly9kazQuZHV0LnVkbi52bi9HX0RLeU5odUNhdS5hc3B4Jz5LaOG6o28gc8OhdCBuaHUgY%2BG6p3UgbeG7nyB0aMOqbSBs4bubcDwvYT48L2xpPjxsaT48YSBJRCA9J2xDb0tIRFRDNicgICBzdHlsZSA9J3dpZHRoOjIwMHB4JyBocmVmPSdodHRwOi8vY2IuZHV0LnVkbi52bi9QYWdlTGljaFRoaUtILmFzcHgnPlRoaSBjdeG7kWkga%2BG7syBs4bubcCBo4buNYyBwaOG6p248L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29LSERUQzcnICAgc3R5bGUgPSd3aWR0aDoyMDBweCcgaHJlZj0nR19ES1RoaU5OLmFzcHgnPlRoaSBUaeG6v25nIEFuaCDEkeG7i25oIGvhu7MsIMSR4bqndSByYTwvYT48L2xpPjxsaT48YSBJRCA9J2xDb0tIRFRDOCcgICBzdHlsZSA9J3dpZHRoOjIwMHB4JyBocmVmPSdHX0xpc3RMaWNoU0guYXNweCc%2BU2luaCBob%2BG6oXQgbOG7m3AgxJHhu4tuaCBr4buzPC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvS0hEVEM5JyAgIHN0eWxlID0nd2lkdGg6MjAwcHgnIGhyZWY9J2h0dHA6Ly9mYi5kdXQudWRuLnZuJz5LaOG6o28gc8OhdCDDvSBraeG6v24gc2luaCB2acOqbjwvYT48L2xpPjxsaT48YSBJRCA9J2xDb0tIRFRDOScgICBzdHlsZSA9J3dpZHRoOjIwMHB4JyBocmVmPSdHX0RLUFZDRC5hc3B4Jz5Ib%2BG6oXQgxJHhu5luZyBwaOG7pWMgduG7pSBj4buZbmcgxJHhu5NuZzwvYT48L2xpPjwvdWw%2BPC9saT48bGk%2BPGEgSUQ9ICdsUGFUUkFDVVUnIHN0eWxlID0nd2lkdGg6NzBweCcgaHJlZj0nJz5EYW5oIHPDoWNoPC9hPjx1bCBjbGFzcz0nc3VibWVudSc%2BPGxpPjxhIElEID0nbENvVFJBQ1VVMDEnICAgc3R5bGUgPSd3aWR0aDoyNDBweCcgaHJlZj0nR19MaXN0Tmd1bmdIb2MuYXNweCc%2BU2luaCB2acOqbiBuZ%2BG7q25nIGjhu41jPC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvVFJBQ1VVMDMnICAgc3R5bGUgPSd3aWR0aDoyNDBweCcgaHJlZj0nR19MaXN0TG9wLmFzcHgnPlNpbmggdmnDqm4gxJFhbmcgaOG7jWMgLSBs4bubcDwvYT48L2xpPjxsaT48YSBJRCA9J2xDb1RSQUNVVTA0JyAgIHN0eWxlID0nd2lkdGg6MjQwcHgnIGhyZWY9J0dfTGlzdENDQ05UVC5hc3B4Jz5TaW5oIHZpw6puIGPDsyBjaOG7qW5nIGNo4buJIENOVFQ8L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29UUkFDVVUwNScgICBzdHlsZSA9J3dpZHRoOjI0MHB4JyBocmVmPSdHX0xpc3RDQ05OLmFzcHgnPlNpbmggdmnDqm4gY8OzIGNo4bupbmcgY2jhu4kgbmdv4bqhaSBuZ%2BG7rzwvYT48L2xpPjxsaT48YSBJRCA9J2xDb1RSQUNVVTA2JyAgIHN0eWxlID0nd2lkdGg6MjQwcHgnIGhyZWY9J2h0dHA6Ly9kYW90YW8uZHV0LnVkbi52bi9TVi9HX0tRdWFBbmhWYW4uYXNweCc%2BU2luaCB2acOqbiB0aGkgVGnhur9uZyBBbmggxJHhu4tuaCBr4buzPC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvVFJBQ1VVMDcnICAgc3R5bGUgPSd3aWR0aDoyNDBweCcgaHJlZj0nR19MaXN0RG9BblROLmFzcHgnPlNpbmggdmnDqm4gbMOgbSDEkOG7kyDDoW4gdOG7kXQgbmdoaeG7h3A8L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29UUkFDVVUwOCcgICBzdHlsZSA9J3dpZHRoOjI0MHB4JyBocmVmPSdHX0xpc3RIb2FuSG9jUGhpLmFzcHgnPlNpbmggdmnDqm4gxJHGsOG7o2MgaG%2FDo24gxJHDs25nIGjhu41jIHBow608L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29UUkFDVVUxNicgICBzdHlsZSA9J3dpZHRoOjI0MHB4JyBocmVmPSdHX0xpc3RIb2FuX1RoaUJTLmFzcHgnPlNpbmggdmnDqm4gxJHGsOG7o2MgaG%2FDo24gdGhpLCB0aGkgYuG7lSBzdW5nPC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvVFJBQ1VVMDknICAgc3R5bGUgPSd3aWR0aDoyNDBweCcgaHJlZj0nR19MaXN0SG9jTGFpLmFzcHgnPlNpbmggdmnDqm4gZOG7sSB0dXnhu4NuIHbDoG8gaOG7jWMgbOG6oWk8L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29UUkFDVVUxMCcgICBzdHlsZSA9J3dpZHRoOjI0MHB4JyBocmVmPSdHX0xpc3RLeUx1YXQuYXNweCc%2BU2luaCB2acOqbiBi4buLIGvhu7cgbHXhuq10PC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvVFJBQ1VVMTEnICAgc3R5bGUgPSd3aWR0aDoyNDBweCcgaHJlZj0nR19MaXN0QmlIdXlIUC5hc3B4Jz5TaW5oIHZpw6puIGLhu4sgaOG7p3kgaOG7jWMgcGjhuqduPC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvVFJBQ1VVMTInICAgc3R5bGUgPSd3aWR0aDoyNDBweCcgaHJlZj0nR19MaXN0TG9ja1dlYi5hc3B4Jz5TaW5oIHZpw6puIGLhu4sga2jDs2Egd2Vic2l0ZTwvYT48L2xpPjxsaT48YSBJRCA9J2xDb1RSQUNVVTEzJyAgIHN0eWxlID0nd2lkdGg6MjQwcHgnIGhyZWY9J0dfTGlzdExvY2tXZWJUYW0uYXNweCc%2BU2luaCB2acOqbiBi4buLIHThuqFtIGtow7NhIHdlYnNpdGU8L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29UUkFDVVUxNCcgICBzdHlsZSA9J3dpZHRoOjI0MHB4JyBocmVmPSdHX0xpc3RIYW5DaGVUQy5hc3B4Jz5TaW5oIHZpw6puIGLhu4sgaOG6oW4gY2jhur8gdMOtbiBjaOG7iSDEkcSDbmcga8O9PC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvVFJBQ1VVMTUnICAgc3R5bGUgPSd3aWR0aDoyNDBweCcgaHJlZj0nR19MaXN0Q2FuaEJhb0tRSFQuYXNweCc%2BU2luaCB2acOqbiBi4buLIGPhuqNuaCBiw6FvIGvhur90IHF14bqjIGjhu41jIHThuq1wPC9hPjwvbGk%2BPC91bD48L2xpPjxsaT48YSBJRD0gJ2xQYUNVVVNWJyBzdHlsZSA9J3dpZHRoOjg4cHgnIGhyZWY9Jyc%2BQ%2BG7sXUgc2luaCB2acOqbjwvYT48dWwgY2xhc3M9J3N1Ym1lbnUnPjxsaT48YSBJRCA9J2xDb0NVVVNWMScgICBzdHlsZSA9J3dpZHRoOjExMHB4JyBocmVmPSdHX0xpc3RUTmdoaWVwLmFzcHgnPsSQw6MgdOG7kXQgbmdoaeG7h3A8L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29DVVVTVjInICAgc3R5bGUgPSd3aWR0aDoxMTBweCcgaHJlZj0nR19MaXN0S2hvbmdUTi5hc3B4Jz5LaMO0bmcgdOG7kXQgbmdoaeG7h3A8L2E%2BPC9saT48L3VsPjwvbGk%2BPGxpPjxhIElEPSAnbFBhQ1NWQycgc3R5bGUgPSd3aWR0aDoxNDVweCcgaHJlZj0nJz5QaMOybmcgaOG7jWMgJiBI4buHIHRo4buRbmc8L2E%2BPHVsIGNsYXNzPSdzdWJtZW51Jz48bGk%2BPGEgSUQgPSdsQ29DU1ZDMDEnICAgc3R5bGUgPSd3aWR0aDoyNDBweCcgaHJlZj0naHR0cDovL2NiLmR1dC51ZG4udm4vUGFnZUNOUGhvbmdIb2MuYXNweCc%2BVMOsbmggaMOsbmggc%2BG7rSBk4bulbmcgcGjDsm5nIGjhu41jPC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvQ1NWQzAyJyAgIHN0eWxlID0nd2lkdGg6MjQwcHgnIGhyZWY9J0dfTGlzdFRoQmlIb25nLmFzcHgnPlRo4buRbmcga8OqIGLDoW8gdGhp4bq%2FdCBi4buLIHBow7JuZyBo4buNYyBo4buPbmc8L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29DU1ZDMDknICAgc3R5bGUgPSd3aWR0aDoyNDBweCcgaHJlZj0nR19TeXNTdGF0dXMuYXNweCc%2BVHLhuqFuZyB0aMOhaSBo4buHIHRo4buRbmcgdGjDtG5nIHRpbiBzaW5oIHZpw6puPC9hPjwvbGk%2BPC91bD48L2xpPjxsaT48YSBJRD0gJ2xQYUxJRU5LRVQnIHN0eWxlID0nd2lkdGg6NTBweCcgaHJlZj0nJz5MacOqbiBr4bq%2FdDwvYT48dWwgY2xhc3M9J3N1Ym1lbnUnPjxsaT48YSBJRCA9J2xDb0xJRU5LRVQxJyAgIHN0eWxlID0nd2lkdGg6NzBweCcgaHJlZj0naHR0cDovL2xpYi5kdXQudWRuLnZuJz5UaMawIHZp4buHbjwvYT48L2xpPjxsaT48YSBJRCA9J2xDb0xJRU5LRVQyJyAgIHN0eWxlID0nd2lkdGg6NzBweCcgaHJlZj0naHR0cDovL2xtczEuZHV0LnVkbi52bic%2BRFVULUxNUzwvYT48L2xpPjwvdWw%2BPC9saT48bGk%2BPGEgSUQ9ICdsUGFIRUxQJyBzdHlsZSA9J3dpZHRoOjQ1cHgnIGhyZWY9Jyc%2BSOG7lyB0cuG7ozwvYT48dWwgY2xhc3M9J3N1Ym1lbnUnPjxsaT48YSBJRCA9J2xDb0hFTFAxJyAgIHN0eWxlID0nd2lkdGg6MjEwcHgnIGhyZWY9J2h0dHA6Ly9mci5kdXQudWRuLnZuJz5D4buVbmcgaOG7lyB0cuG7oyB0aMO0bmcgdGluIHRy4buxYyB0dXnhur9uPC9hPjwvbGk%2BPGxpPjxhIElEID0nbENvSEVMUDInICAgc3R5bGUgPSd3aWR0aDoyMTBweCcgaHJlZj0naHR0cHM6Ly9kcml2ZS5nb29nbGUuY29tL2ZpbGUvZC8xWjBxbGJoS2FTR216RVpKRDJ1QjRlVVdlZUhhUTlISGwvdmlldyc%2BSMaw4bubbmcgZOG6q24gxJDEg25nIGvDvSBo4buNYzwvYT48L2xpPjxsaT48YSBJRCA9J2xDb0hFTFAzJyAgIHN0eWxlID0nd2lkdGg6MjEwcHgnIGhyZWY9J2h0dHA6Ly9kYW90YW8uZHV0LnVkbi52bi9kb3dubG9hZDIvRW1haWxfR3VpZGUucGRmJz5IxrDhu5tuZyBk4bqrbiBT4butIGThu6VuZyBFbWFpbCBEVVQ8L2E%2BPC9saT48bGk%2BPGEgSUQgPSdsQ29IRUxQNycgICBzdHlsZSA9J3dpZHRoOjIxMHB4JyBocmVmPSdodHRwOi8vZHV0LnVkbi52bi9UcmFuZ3Npbmh2aWVuJz5WxINuIGLhuqNuIFF1eSDEkeG7i25oIGPhu6dhIFRyxrDhu51uZzwvYT48L2xpPjxsaT48YSBJRCA9J2xDb0hFTFA4JyAgIHN0eWxlID0nd2lkdGg6MjEwcHgnIGhyZWY9J2h0dHBzOi8vdGlueXVybC5jb20veTRrZGozc3AnPkJp4buDdSBt4bqrdSB0aMaw4budbmcgZMO5bmc8L2E%2BPC9saT48L3VsPjwvbGk%2BPGxpPjxhIGlkID0nbGlua0RhbmdOaGFwJyBocmVmPSdQYWdlRGFuZ05oYXAuYXNweCcgc3R5bGUgPSd3aWR0aDo4MHB4Oyc%2BIMSQxINuZyBuaOG6rXAgPC9hPjwvbGk%2BPGxpPjxkaXYgY2xhc3M9J0xvZ2luRnJhbWUnPjxkaXYgc3R5bGUgPSdtaW4td2lkdGg6IDEwMHB4Oyc%2BPC9kaXY%2BPC9kaXY%2BPC9saT48L3VsPmQCCQ9kFgICAQ9kFgICAQ9kFgQCAQ8QZBAVEQpU4bqldCBj4bqjC0suIEPGoSBraMOtGksuIEPDtG5nIG5naOG7hyBUaMO0bmcgdGluF0suIEPGoSBraMOtIEdpYW8gdGjDtG5nKEsuIEPDtG5nIG5naOG7hyBOaGnhu4d0IC0gxJBp4buHbiBs4bqhbmgKSy4gxJBp4buHbh1LLiDEkGnhu4duIHThu60gVmnhu4VuIHRow7RuZwdLLiBIw7NhG0suIEPGoSBraMOtIEdpYW8gdGjDtG5nIChTKR5LLiBYw6J5IGThu7FuZyBD4bqndS3EkMaw4budbmcrSy4gWMOieSBk4buxbmcgRMOibiBk4bulbmcgJiBDw7RuZyBuZ2hp4buHcCJLLiBYw6J5IGThu7FuZyBDw7RuZyB0csOsbmggdGjhu6d5EUsuIE3DtGkgdHLGsOG7nW5nFksuIFF14bqjbiBsw70gZOG7sSDDoW4PSy4gS2nhur9uIHRyw7pjL0suIEtob2EgaOG7jWMgQ8O0bmcgbmdo4buHIHRpw6puIHRp4bq%2FbiAtIFBGSUVWJ0suIEtob2EgaOG7jWMgQ8O0bmcgbmdo4buHIHRpw6puIHRp4bq%2FbhURA0FMTAMxMDEDMTAyAzEwMwMxMDQDMTA1AzEwNgMxMDcDMTA4AzEwOQMxMTADMTExAzExNwMxMTgDMTIxAzEyMgMxMjMUKwMRZ2dnZ2dnZ2dnZ2dnZ2dnZ2dkZAIDDxBkEBUQClThuqV0IGPhuqMEMjAwNgQyMDA3BDIwMDgEMjAwOQQyMDEwBDIwMTEEMjAxMgQyMDEzBDIwMTQEMjAxNQQyMDE2BDIwMTcEMjAxOAQyMDE5BDIwMjAVEApU4bqldCBj4bqjBDIwMDYEMjAwNwQyMDA4BDIwMDkEMjAxMAQyMDExBDIwMTIEMjAxMwQyMDE0BDIwMTUEMjAxNgQyMDE3BDIwMTgEMjAxOQQyMDIwFCsDEGdnZ2dnZ2dnZ2dnZ2dnZ2dkZGSEdHSRXF4e16opts7K1MmZKYkhR%2B11%2FP3wk6cvQVGoqQ%3D%3D&__VIEWSTATEGENERATOR=A48050C6&ctl00%24MainContent%24DSKTN_cboKhoa=102&ctl00%24MainContent%24DSKTN_cboKhoaTS=2015&ctl00%24MainContent%24DDorder=X%E1%BA%BFp+theo%3A+Khoa%2C+Kh%C3%B3a%2C+T%C3%AAn&ctl00%24MainContent%24DSKTN_btnDuLieu=D%E1%BB%AF+li%E1%BB%87u" http://sv.dut.udn.vn/G_ListKhongTN.aspx',shell=True)
result = result.decode(encoding="UTF-8",errors='strict')
result = str(result).replace('\\r', '')
result = result[result.find('STT'):]
result = str(result).replace('</td>', ',')
result = str(result).replace('</th>', ',')
result = str(result).replace('\\t', '')
result = str(result).replace(' ', '')
# result = str(result).replace('\'', '\n')
result = cleanhtml(result)
while ('\\n\\n' in result):
    result = str(result).replace('\\n\\n','\\n')
result = str(result).replace('\\n', '\n')
while (',,' in result):
    result = str(result).replace(',,', ',-1,')
# print(result)
with open('writeData.csv', mode='w') as file:
    writer = csv.writer(file)
    writer.writerow(result)